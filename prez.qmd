---
title: "Numerical Modeling of Heat & Mass Transfers in Stefan-type Flows Using a Sharp Interface Two-Fluid Formulation"
authors: 
  L. Libat, 
  E. Chénier, 
  C. Selçuk,
  V. Le Chenadec 
date: today
date-format: long
institute: "Multiscale Modeling and Simulation Laboratory, Gustave Eiffel University, Champs-sur-Marne, France"
bibliography: references.bib
highlight-style: github
format:
    revealjs: 
        filters: [custom.lua]
        theme: default
        logo: images/msmelog.png
        css: styles.css
        slide-number: true
        preview-links: auto
        toc: true
        toc-depth: 1
        footer: |
            <p>© 2025 L. Libat, V. Le Chenadec, E. Chénier, C.Selçuk </p>
---

# Introduction

## Context & Challenges

- **Interfacial Flows:** Two immiscible phases separated by a sharp interface
- **Phase Change:** Solid ⇄ liquid, driven by latent heat
- **Applications:** Material processing, ice melting, crystal growth ...

![](images/ice.jpg){width=0% fig-align="center"}

---

## Stefan-type Problems

::: {layout-ncol=2}
- Classical phase change problems where a moving boundary separates phases
- Interface position $s(t)$ depends on temperature gradients $\nabla T_i$

![](images/ice_melting.gif){width=70% fig-align="center"}
:::

**Key Equation (Two-Phase Stefan)**

$$
\begin{aligned}
&\text{Find } T_i(x,t)\ \text{and interface } s(t) \text{ such that:}\\
&\quad \partial_t T_i - \nabla\cdot(k_i\,\nabla T_i) = 0, \quad x \in \Omega_i(t),\\
&\quad T_i(s(t),t) = T_m, \quad 
\rho\,L\,\frac{ds}{dt} \;=\; ⟦ k_i\,\nabla T_i \cdot \mathbf{n}⟧.
\end{aligned}
$$

---

## Primary Challenges

::: {.border .p-2}
| **Challenges** | | **Our Approach** |
|:---------------|:-:|:----------------|
| Sharp Interface Modeling | → | Cut-Cell on Cartesian Grid |
| Conservation with Moving Domains | → | Space-Time Framework |
| Interface Jump Conditions | → | Two-Fluid Formulation |
| Interface Update | → | Fixed-Point Iteration |
| Numerical Stability | → | Implicit Interface Coupling |
:::

# Cut Cell Method for static interfaces

## Two-Phase Discretization

::: {layout-ncol=2}
- Interface divides domain into regions
- Each phase has its own heat equation
- Coupled via jump conditions at interface
- Unknowns: Bulk temperature and interface temperature

![](images/cut_cell_with_conditions.svg){width=50% fig-align="center"}
:::

---

## Cut-Cell Discretization

$$
\begin{aligned}
\frac{\partial T_i}{\partial t} - \nabla \cdot (k_i \nabla T_i) &= S_i \quad \text{in } \Omega_i, \quad i=1,2 \\
\end{aligned}
$$

Integrating over control volume and integrating in time:

$$
\int_{\Omega_i} (T^{n+1} - T^n) \, dV = \Delta t \left[ \int_{\partial\Omega_i \setminus \Gamma_i} k \nabla \tilde{T} \cdot \mathbf{n} \, dS + \int_{\Gamma_i} k \nabla \tilde{T} \cdot \mathbf{n} \, dS + \int_{\Omega_i} \tilde{S} \, dV \right]
$$

::: {layout-ncol=2}
- Standard finite volume integration
- Split boundary into regular faces and interface
- Interface requires special treatment
- Ensures conservation across phases

![](images/interface_cut_cell_formulation.png){width=100% fig-align="center"}
:::

---

## Cut-Cell Discretization

After discretization for cells cut by the interface:

$$
V_i(T_i^{n+1} - T_i^n) = \Delta t \left[ \sum_{f \in \text{reg}} k A_f \nabla_f(\tilde{T}) + F_{\Gamma} + S_i V_i \right]
$$

Interface flux $F_{\Gamma}$ depends on boundary conditions:

- **Dirichlet**: $T=g(\mathbf{x})$ → $F_{\Gamma} = k A_{\Gamma} \nabla_{\Gamma}(\tilde{T})$
- **Neumann**: $k \nabla T \cdot \mathbf{n} = q_{\Gamma}$ → $F_{\Gamma} = q_{\Gamma} A_{\Gamma}$
- **Robin**: $\alpha T + \beta k \nabla T \cdot \mathbf{n} = g$

---

## Discretized System

$$
\begin{bmatrix}
\text{Bulk part Heat Equation} & \text{Interface part Heat Equation} \\
\text{Interface part BC} & \text{Interface part BC}
\end{bmatrix}
\begin{bmatrix}
T^{n+1}_{\text{bulk}} \\
T^{n+1}_{\text{interface}}
\end{bmatrix} =
RHS
$$

- Implicit time-stepping
- Coupling between bulk and interface terms
- Enforce boundary conditions directly in the system
- ⚠️ **No need for ghost cells or extrapolation**

--- 

## Validation: 2D Two-Phase Heat Equation

To validate the method, [see @2025TwoPhase]

$\Omega_1$ is a disk with radius $R$ in a unit square domain $\Omega_2$

::: {#fig-heat2 layout-ncol=2}
![Convergence Results](images/two_phase_conv.png){width=100%}

![Temperature Field](images/heat_2d_2ph_henry_end.png){width=100%}

Second-order convergence in $L^2$ norm for regular cells, superlinear for cut cells
:::

# Cut Cell Method for moving interfaces

## Space-Time Approach

- Combine time with spatial domain (extrude cells across $\Delta t$)
- Preserves conservation across time steps especially for discrete events

![From 1D Space to 2D Space-Time](images/space_time.gif){width="80%" fig-align="center"}

---

## Fresh/Dead Cell Problem

- Cells may change status as interface moves:
  - **Fresh cells:** Empty at $t^n$, wet at $t^{n+1}$
  - **Dead cells:** Wet at $t^n$, empty at $t^{n+1}$

![](images/fresh_dead_cells_visualization.png){width=80% fig-align="center"}

- Our space-time approach preserves conservation even with changing domain

---

## VOF Advection vs. Fixed-Point Method

::: {layout-ncol="2"}
::: {.column}
**Traditional VOF Approach:**

$$
\frac{\partial \alpha}{\partial t} + \nabla\cdot(\alpha\,\mathbf{u}) = 0
$$

- **Challenges:**
  - Velocity extension near interface
  - Numerical diffusion over time
  - Operator splitting errors

![VOF Advection Schematic](images/vof_advection.png){width=90%}
:::

::: {.column}
**Our Fixed-Point Method:**

$$
\rho L \frac{ds}{dt} = ⟦\mathbf{q}\cdot\mathbf{n}⟧ \Rightarrow V_i^{n+1,(k+1)} = V_i^n + \text{res}_i^{(k)}
$$

- **Advantages:**
  - Direct enforcement of Stefan condition
  - Guaranteed conservation
  - No artificial velocity field needed

![Newton-Based Schematic](images/rootfindingnewton.jpg){width=55%}
:::
:::

---

## Fixed-Point Iteration for Interface Tracking

- **Key Challenge:** Interface position depends on temperature field, and vice versa
- **Stefan Condition:** $\rho\,L\,\dot{s} = ⟦\mathbf{q}\cdot\mathbf{n}⟧$

We formulate this as a fixed-point problem on cell volumes:

$$V_i^{n+1,(k+1)} = V_i^n + \text{res}_i^{(k)}$$

Where:

- $V_i^{n+1,(k)}$ is the cell volume at iteration $k$
- $V_i^n$ is the initial cell volume
- $\text{res}_i^{(k)}$ is the residual based on the Stefan condition

---

## Fixed-Point Theoretical Framework

- Our interface update can be written as: $V^{n+1,(k+1)} = f(V^{n+1,(k)})$
- **Banach Fixed-Point Theorem** guarantees:
  - Existence and uniqueness of a fixed point
  - Convergence if $f$ is a contraction mapping

::: {layout-ncol=2}

- For some $L < 1$: $|f(x) - f(y)| \leq L|x - y|$
- Error decreases by factor $L$ each iteration
- After $n$ iterations: $|V_n - V^*| \leq \frac{L^n}{1-L}|V_0 - V^*|$

![](images/fixedpoint/stefan_fixed_point_summary.png){width=90%}
:::

---

## Conservation Properties

- **Volume Conservation:** Our method directly enforces the Stefan condition at each iteration
- **Energy Conservation:**
  - Interface moves to satisfy heat flux balance: $\rho\,L\,(V_i^{n+1} - V_i^n) = \mathcal{F}_\Gamma$
  - Even nearly-vanishing dead cells are computed to preserve global energy

::: {layout-ncol=2}
- No artificial energy creation/loss
- Maintains sharp interface (no smearing)
- Applicable to non-trivial phase change problems

![Temperature profile with conservation](images/temp_stef_1d_2ph.png){width=90%}
:::

---

## Test Case: 2D Stefan Problem

- Fusion of a solid slab
- Initial temperature $T_0 = 0$ (cooled melting)
- Dirichlet boundary condition $T = 1$

::: {layout-ncol="2"}
![Interface convergence](images/stefan_2d_Inter_Conv.png){width=100%}

![Temperature profile](images/stefan_2D_2ph_temp3.gif){width=100% fig-align="center"}
:::

---

## Convergence Properties

- Linear convergence observed ($O(k^{1.1})$)
- Efficient with good initial guess (extrapolation or velocity-based)

::: {layout-ncol="2"}
![Residual decay](images/stefan_1D_residual.png){width=80%}

![Iterations per timestep](images/residual_withguess.png){width=80%}
:::

# Conclusion & Perspectives

## Key Achievements

- **Cut-cell method for two-phase problems**
  - Conservation guaranteed
  - Superlinear convergence
  - No interpolation needed for boundary conditions

- **Space-time framework for moving interfaces**
  - Properly handles discrete events (fresh/dead cells)
  - Maintains conservation

- **Implicit interface tracking**
  - Fixed-point iterative procedure
  - Enforces physics-based interface movement

---

## Future Work

- Front-tracking approach for interface representation
- Extension to Navier-Stokes equations for two-phase flows
- Preconditioning strategies and parallelization

::: {layout-ncol=2}
![](images/star_evolution.gif){width=80%}

![](images/Domain-decomposition.png){width=80%}
:::

# Questions ?
Thank you for your attention!

# Appendix {.appendix visibility="uncounted"}

## Front-Tracking Enhancement

- Interface represented by a set of markers with positions $\vec{X}_I$
- Interface update formulated as optimization problem:

$$
\mathbf{X}^{n+1} = \text{argmin} \left\{ \sum_i \left| F_i \right|^2 \right\}
$$

Where $F_i = \rho L (V_i^{n+1} - V_i^{n}) - ⟦\mathbf{q}^\gamma\cdot\mathbf{n}⟧$ is the Stefan condition residual

::: {layout-ncol=2}
![](images/star_evolution.gif){width=80%}

**Solution via non-linear least squares:**
- Jacobian matrix: $J_{i,J} = \rho L \frac{\partial V_i^{n+1}}{\partial X_J}$
- Levenberg-Marquardt update:
  $\mathbf{X}^{n+1} = \mathbf{X}^{n} - (J^T J + \lambda D)^{-1} J^T \mathbf{F}$
:::

## References

::: {#refs}
:::