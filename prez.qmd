---
title: "Numerical Modeling of Heat & Mass Transfers in Stefan-type Flows Using a Sharp Interface Two-Fluid Formulation"
authors: 
  L. Libat, 
  E. Chénier, 
  C. Selçuk,
  V. Le Chenadec 
date: today
date-format: long
institute: "Multiscale Modeling and Simulation Laboratory, CNRS MSME UMR 8208, Gustave Eiffel University"
bibliography: references.bib
highlight-style: github
format:
    revealjs: 
        filters: [custom.lua]
        theme: default
        logo: images/msmelog.png
        css: styles.css
        slide-number: true
        preview-links: auto
        toc: false
        toc-depth: 1
        footer: |
            <p>© 2025 L. Libat, E. Chénier, C.Selçuk, V. Le Chenadec</p>
---

# Introduction

## Context & Challenges

- **Interfacial Flows:** Two immiscible phases separated by a sharp interface
- **Phase Change:** Solid ⇄ liquid, limited by latent heat or diffusion
- **Applications:** Material processing, ice melting, crystal growth ...

![](images/ice.jpg){fig-align="center"}

---

## Stefan-type Problems

- Classical phase change problems where a moving boundary separates phases
- Interface position $s(t)$ depends on heat fluxes $k_p \nabla T_p$
$$
\begin{aligned}
&\text{Find $T_s$, $T_l$ and interface position $s(t)$ such that:}\\
&\partial_t T_s - \alpha_s\nabla^2 T_s = 0 \quad \text{in solid phase}\\
&\partial_t T_l - \alpha_l\nabla^2 T_l = 0 \quad \text{in liquid phase}\\
&\rho L\dot{s} = k_l\nabla T_l \cdot \mathbf{n} - k_s\nabla T_s \cdot \mathbf{n} \quad \text{at interface}\\
&T_s = T_l = T_m \quad \text{at interface}\\
\end{aligned}
$$

![](images/ice_melting.gif){width=100% fig-align="center"}

---

## Primary Challenges

![](images/difficulties.png){width=100% fig-align="center"}

# Cut Cell Method for static interfaces

## Two-Fluid Formulation Philosophy

::: {layout-ncol=2}
![Cartesian grid with interface $\Gamma$ separating solid/liquid regions](images/cut_cell_with_conditions.svg){width=100% fig-align="center"}

::: {.column}
**4 Equations: Bulk \& Interface**
$$
\begin{cases}
\frac{\partial T_s}{\partial t} = \alpha_s \nabla^2 T_s \quad \text{in } \Omega_s \\
\frac{\partial T_l}{\partial t} = \alpha_l \nabla^2 T_l \quad \text{in } \Omega_l \\
\end{cases}
$$

$$
\begin{cases}
\begin{aligned}
⟦T⟧ &= g(\mathbf{x}) \quad \text{on } \Gamma \\
⟦k \nabla T \cdot \mathbf{n}⟧ &= h(\mathbf{x}) \quad \text{on } \Gamma
\end{aligned}
\end{cases}
$$

**4 Unknowns:**

- Bulk temperatures: $T_s$, $T_l$
- Interface temperatures: $T_s^\Gamma$, $T_l^\Gamma$

:::
:::


---

## Cut-Cell Discretization

::: {layout-ncol=2}
::: {.column}
For each phase, we have the heat equation:
$$
\begin{aligned}
\frac{\partial T_p}{\partial t} - \nabla \cdot (k_p \nabla T_p) &= S_p \quad \text{in } \Omega_p
\end{aligned}
$$

Integrating over control volume and integrating in time:
:::

::: {.column}
![](images/two_phase_cell_formulation.png){width=80% fig-align="center"}
:::
:::


$$
\small
\int_{\Omega_p} (T_p^{n+1} - T_p^n) \, dV = \Delta t \left[ \color{blue}{\int_{\partial\Omega_p \setminus \Gamma} k_p \nabla \tilde{T}_p \cdot \mathbf{n}_p \, dS} + \color{red}{\int_{\Gamma} k_p \nabla \tilde{T_p} \cdot \mathbf{n}_p \, dS} + \int_{\Omega_p} \tilde{S_p} \, dV \right]
$$


---

## Cut-Cell Discretization

For each phase (solid, liquid), the discretization leads to:
$$
V_p(T_p^{n+1} - T_p^n) = \Delta t \left[ \sum_{f \in \text{reg}} k_p A_f \nabla_f(\tilde{T}_p) \cdot \mathbf{n_f}+ F_p^{\Gamma} + S_p V_p \right]
$$

Where:

- Fluxes are computed using Stokes' theorem on staggered cells $\int_{\Omega_{f}} \nabla T \, dV = \int_{\partial\Omega_{f}} T \mathbf{n} \, dS$ 

Boundary conditions at the interface are defined as:

::: {layout-ncol=2}
**Temperature Jump:**
$$
\begin{aligned}
⟦T⟧ &= g \quad \text{on } \Gamma \\
T_s^\Gamma -  T_l^\Gamma &= g(\mathbf{x})
\end{aligned}
$$

**Heat Flux Jump:**
$$
\begin{aligned}
⟦k \nabla T \cdot \mathbf{n}⟧ &= h(\mathbf{x}) \quad \text{on } \Gamma \\
F_s^\Gamma - F_l^\Gamma &= A_\Gamma h(\mathbf{x})
\end{aligned}
$$
:::

---

## Discretized System

$$
\begin{bmatrix}
M_{\text{bulk}}^s & M_{\text{int}}^s & 0 & 0 \\
I & 0 & - I & 0 \\
0 & 0 & M_{\text{bulk}}^l & M_{\text{int}}^l \\
F_{\text{bulk}}^s & F_{\text{int}}^s & F_{\text{bulk}}^l & F_{\text{int}}^l
\end{bmatrix}
\begin{bmatrix}
T^{n+1}_{\text{s}} \\
T^{n+1,\Gamma}_{\text{s}} \\
T^{n+1}_{\text{l}} \\
T^{n+1,\Gamma}_{\text{l}}
\end{bmatrix} =
\begin{bmatrix}
\text{RHS}_s \\
g \\
\text{RHS}_l \\
A_\Gamma h
\end{bmatrix}
$$

- Implicit time-stepping
- Coupling between bulk and interface terms
- Enforce boundary conditions directly in the system
- ⚠️ **No need for ghost cells or extrapolation**

---

## Validation Case: 2D Two-Phase Heat Equation

::: {layout-ncol=2}
::: {.column}
$$
\begin{aligned}
\frac{\partial T_p}{\partial t} - \nabla \cdot (k_p \nabla T_p) &= 0 \quad \text{in } \Omega_p \\
T_s - \beta_l T_l &= 0 \quad \text{on } \Gamma, \\
k_s \nabla T_s \cdot \mathbf{n} - k_l \nabla T_l \cdot \mathbf{n} &= 0 \quad \text{on } \Gamma, \\
\end{aligned}
$$
:::

::: {.column}
![](images/henry_scheme.svg){width=100%}
:::
:::


Analytical solution:
$$
\small
\begin{aligned}
T_s(r,t) &= \frac{4 T_{s,0} k_s k_l^2 \beta_l}{\pi^2 R} \int_0^{\infty} \exp{(-k_s u^2 t)} \frac{J_0(ur) J_1(uR)}{u^2(\Phi^2(u) + \Psi^2(u))} du \\
T_l(r,t) &= \frac{2 T_{l,0} k_s \sqrt{k_l} \beta_l}{\pi} \int_0^{\infty} \exp{(-k_s u^2 t)} \frac{J_1(uR)(J_0(k ur)\Phi(u) - Y_0(k ur)\Psi(u))}{u(\Phi^2(u) + \Psi^2(u))} du
\end{aligned}
$$

---

## Validation: 2D Two-Phase Heat Equation

::: {#fig-heat3 layout-ncol=1}
![Temperature field](images/heat_2d_2ph_henry_end.png){width=80%}

Sharp interface with no spurious oscillations
:::

---

## Validation: 2D Two-Phase Heat Equation

::: {#fig-heat2 layout-ncol=1}
![Convergence Results](images/two_phase_conv.png){width=60%}

Second-order convergence in $L^2$ norm for regular cells, superlinear for cut cells
:::

# Cut Cell Method for moving interfaces

## Space-Time Approach

- Combine time with spatial domain (extrude cells across $\Delta t$)
- Discrete events (**fresh/dead cells**) carefully handled

![From 1D Space to 2D Space-Time](images/space_time.gif){width="80%" fig-align="center"}

## Space-Time Discretization

**Reynolds Transport Theorem:**

$$\frac{d}{dt} \int_{\Omega(t)} f\, dV = \int_{\Omega(t)} \frac{\partial f}{\partial t}\, dV + \int_{\partial \Omega(t)} \bigl(\mathbf{w}\cdot\mathbf{n}\bigr) f\, dS$$

Applied to heat equation in moving domain:

\normalsize
$$
\left[ \int_{\Omega_p(t)}\! T_p\,dV\right]_{t_{n}}^{t^{n+1}} = \int_{t^n}^{t^{n+1}}\int_{\partial\Omega_p(t)} k_p \nabla T_p \cdot \mathbf{n} dS dt + \int_{t^n}^{t^{n+1}}\int_{\partial\Omega_p(t)} \Bigl(\mathbf{w}\!\cdot\!\mathbf{n}\Bigr) T_p\,dS dt 
$$

- Same discretization as before 
- Additional term for moving interface

---

## VOF Advection vs. Iterative Method

::: {layout-ncol="2"}
::: {.column}
**Traditional VOF Approach:**

$$
\frac{\partial c}{\partial t} + \mathbf{u} \cdot \nabla c = 0
$$

- **Challenges:**
  - Velocity extension
  - Decoupling of interface and temperature field

![VOF Advection Schematic](images/vof_advection.png){width=90%}
:::

::: {.column}
**Our Iterative Method:**


$$
\rho L \frac{\partial s}{\partial t} - ⟦k \nabla T \cdot\mathbf{n}⟧ = 0 \leftrightarrow F(s,T) = 0
$$

- **Advantages:**
  - Enforces conservation localy 
  - Interface update coupled with temperature field

![Newton-Based Schematic](images/rootfindingnewton.jpg){width=55%}
:::
:::

---

## Newton Iteration for Interface update

- **Interface Representation**: Height function $y=s(x)$ with position $\mathbf{x}_\Gamma$

- **Stefan Condition as Root-Finding Problem**: 
  $$\rho\,L\,\dot{s} - ⟦k \nabla T\cdot\mathbf{n}⟧ = 0 \quad \Rightarrow \quad F(\mathbf{x}_\Gamma) = 0$$

- **Newton Iteration Method**:
  $$\mathbf{x}_\Gamma^{n+1,(k+1)} = \mathbf{x}_\Gamma^{n+1,(k)} - \left(\frac{\partial F^{(k)}}{\partial \mathbf{x}_\Gamma}\right)^{-1}F(\mathbf{x}_\Gamma^{n+1,(k)})$$

::: {layout-ncol=2}
![](images/newton_update.svg){width=100%, fig-align="center"}

- Iterate until convergence: $\|F(\mathbf{x}_\Gamma^{n+1,(k)})\| < \epsilon$
- Each iteration requires solving temperature field on updated domain
:::

---

## Test Case: 2D Two-Phase Stefan Problem

::: {layout-nrow=2}
- Fusion of a solid slab
- Initial position off equilibrium

![](images/stef_bc_test.svg){width=100% fig-align="center"}

![Interface convergence](images/stefan_2d_Inter_Conv.png){width=100%}

![Interface position](images/stefan_1D_interface.png){width=100%}
:::

---

## Convergence Properties

- Linear convergence observed ($O(k^{1.1})$)
- Efficient with good initial guess (extrapolation or velocity-based)

![Residuals (log10)](images/residual_withguess.png){width=80%}

---

## Mullins-Sekerka Instability Test

::: {layout-ncol=2}
::: {.column}
**Interface Perturbation**

- Small waves on solid-liquid interface
- Some modes grow, some decay

![Growth amplitude](images/growing_interface_ampl.png){width=90%}
:::

::: {.column}
**Pattern Formation**

- Initial small perturbation
- Develops into dendrite pattern

![Growing dendrite](images/mullins_sekerka_interface1.png){width=90%}
:::
:::

# Conclusion & Perspectives

## Key Achievements

- **Cut-cell method for two-phase problems**
  - Conservation guaranteed
  - Superlinear convergence
  - No interpolation needed for boundary conditions

- **Space-time finite volume for moving interfaces**
  - Properly handles discrete events (fresh/dead cells)
  - Maintains conservation

- **Implicit interface representation**
  - No velocity extension, no reinitialization
  - Newton iteration for interface update
  - Coupling between interface update and temperature field


# Questions ?
Thank you for your attention!

# Appendix {.appendix visibility="uncounted"}

## Future Work

- Front-tracking approach for interface representation :
  - Interface represented by a set of markers
  - Optimization problem to update interface position
  - Non-linear least squares solver for interface update
- Extension to Navier-Stokes equations for two-phase flows :
  - Coupling with momentum equations
  - Implicit treatment of interface coupling
  - Fully coupled system of equations
- Preconditioning strategies and parallelization : 
  - Efficient solvers for large systems
  - Parallel implementation

## Fixed-Point Theoretical Framework

- **Fixed-Point Formulation**: $\mathbf{x}_\Gamma^{n+1,(k+1)} = f(\mathbf{x}_\Gamma^{n+1,(k)})$

- **Banach Fixed-Point Theorem**: Guarantees convergence if $f$ is contractive. Existence (and uniqueness) of fixed point $\mathbf{x}_\Gamma^{n+1}$.

- **Contraction Property**: $\|f(\mathbf{x}_1) - f(\mathbf{x}_2)\| \leq L\|\mathbf{x}_1 - \mathbf{x}_2\|,\quad L < 1$

![](images/stefan_fixed_point_analysis_step2.png){height=700 fig-align="center"}

---


## Front-Tracking Enhancement

- Interface represented by a set of markers with positions $\vec{X}_I$
- Interface update formulated as optimization problem: $\mathbf{X}^{n+1} = \text{argmin} \left\{ \sum_i \left| F_i \right|^2 \right\}$

Where $F_i = \rho L (V_i^{n+1} - V_i^{n}) - ⟦\nabla T \cdot\mathbf{n}⟧$ is the Stefan condition residual

::: {layout-ncol=2}
![](images/star_evolution.gif){width=80%}

- **Solution via non-linear least squares:**
- Jacobian matrix: $J_{i,J} = \rho L \frac{\partial V_i^{n+1}}{\partial X_J}$
- Levenberg-Marquardt update:
  $\mathbf{X}^{n+1} = \mathbf{X}^{n} - (J^T J + \lambda D)^{-1} J^T \mathbf{F}$
:::

--- 

## Appendix : Gradient Calculation at the interface

::: {layout-ncol=2}
![Johansen and Colella method](images/colella_grad.svg){width=85%}

![Our cut cell method](images/interface_grad.svg){width=100%}
:::

::: {layout-ncol=2}
2nd order gradient calculation at the interface using Johansen and Colella method

Gradient calculation at the interface using our cut-cell method (1st order)
:::

## Appendix : Prescribed Interface Motion

- No parasitic oscillations
- Minimium cell number to resolve the interface : $6 \times 6$ cells

![](images/shrinking.gif){width=100% fig-align="center"}


## References

::: {#refs}
:::

## References {visibility="hidden"}

@2025TwoPhase
@Chen1997
@Mullins1964
@Polyanin2016
@Popinet2009
@Remmerswaal2022
@Stefan1891
@Weymouth2010
@Quirós2024